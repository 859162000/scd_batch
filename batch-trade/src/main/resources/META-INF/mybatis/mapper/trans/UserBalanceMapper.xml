<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.miaoqian.transvc.dao.UserBalanceMapper" >
    <resultMap id="BaseResultMap" type="com.miaoqian.transvc.domain.UserBalance" >
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="uid" property="uid" jdbcType="VARCHAR" />
        <result column="operate_type" property="operateType" jdbcType="VARCHAR" />
        <result column="usable_sa" property="usableSa" jdbcType="DECIMAL" />
        <result column="withdraw_freeze_sa" property="withdrawFreezeSa" jdbcType="DECIMAL" />
        <result column="invest_freeze_sa" property="investFreezeSa" jdbcType="DECIMAL" />
        <result column="repay_freeze_sa" property="repayFreezeSa" jdbcType="DECIMAL" />
        <result column="current_capital" property="currentCapital" jdbcType="DECIMAL" />
        <result column="current_interest" property="currentInterest" jdbcType="DECIMAL" />
        <result column="current_total_capital" property="currentTotalCapital" jdbcType="DECIMAL" />
        <result column="current_total_interest" property="currentTotalInterest" jdbcType="DECIMAL" />
        <result column="fixend_capital" property="fixendCapital" jdbcType="DECIMAL" />
        <result column="fixend_interest" property="fixendInterest" jdbcType="DECIMAL" />
        <result column="fixend_total_capital" property="fixendTotalCapital" jdbcType="DECIMAL" />
        <result column="fixend_total_interest" property="fixendTotalInterest" jdbcType="DECIMAL" />
        <result column="fixperiod_capital" property="fixperiodCapital" jdbcType="DECIMAL" />
        <result column="fixperiod_interest" property="fixperiodInterest" jdbcType="DECIMAL" />
        <result column="fixperiod_total_capital" property="fixperiodTotalCapital" jdbcType="DECIMAL" />
        <result column="fixperiod_total_interest" property="fixperiodTotalInterest" jdbcType="DECIMAL" />
        <result column="recharge_total_amt" property="rechargeTotalAmt" jdbcType="DECIMAL" />
        <result column="recharge_total_count" property="rechargeTotalCount" jdbcType="INTEGER" />
        <result column="withdraw_total_amt" property="withdrawTotalAmt" jdbcType="DECIMAL" />
        <result column="withdraw_total_count" property="withdrawTotalCount" jdbcType="INTEGER" />
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    </resultMap>
    <sql id="Base_Column_List" >
        id, uid, operate_type, usable_sa, withdraw_freeze_sa, invest_freeze_sa, repay_freeze_sa,
        current_capital, current_interest, current_total_capital, current_total_interest,
        fixend_capital, fixend_interest, fixend_total_capital, fixend_total_interest, fixperiod_capital,
        fixperiod_interest, fixperiod_total_capital, fixperiod_total_interest, recharge_total_amt,
        recharge_total_count, withdraw_total_amt, withdraw_total_count, update_time
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
        select
        <include refid="Base_Column_List" />
        from user_balance
        where id = #{id,jdbcType=INTEGER}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
        delete from user_balance
        where id = #{id,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.miaoqian.transvc.domain.UserBalance" >
        insert into user_balance (id, uid, operate_type,
        usable_sa, withdraw_freeze_sa, invest_freeze_sa,
        repay_freeze_sa, current_capital, current_interest,
        current_total_capital, current_total_interest,
        fixend_capital, fixend_interest, fixend_total_capital,
        fixend_total_interest, fixperiod_capital,
        fixperiod_interest, fixperiod_total_capital,
        fixperiod_total_interest, recharge_total_amt,
        recharge_total_count, withdraw_total_amt, withdraw_total_count,
        update_time)
        values (#{id,jdbcType=INTEGER}, #{uid,jdbcType=VARCHAR}, #{operateType,jdbcType=VARCHAR},
        #{usableSa,jdbcType=DECIMAL}, #{withdrawFreezeSa,jdbcType=DECIMAL}, #{investFreezeSa,jdbcType=DECIMAL},
        #{repayFreezeSa,jdbcType=DECIMAL}, #{currentCapital,jdbcType=DECIMAL}, #{currentInterest,jdbcType=DECIMAL},
        #{currentTotalCapital,jdbcType=DECIMAL}, #{currentTotalInterest,jdbcType=DECIMAL},
        #{fixendCapital,jdbcType=DECIMAL}, #{fixendInterest,jdbcType=DECIMAL}, #{fixendTotalCapital,jdbcType=DECIMAL},
        #{fixendTotalInterest,jdbcType=DECIMAL}, #{fixperiodCapital,jdbcType=DECIMAL},
        #{fixperiodInterest,jdbcType=DECIMAL}, #{fixperiodTotalCapital,jdbcType=DECIMAL},
        #{fixperiodTotalInterest,jdbcType=DECIMAL}, #{rechargeTotalAmt,jdbcType=DECIMAL},
        #{rechargeTotalCount,jdbcType=INTEGER}, #{withdrawTotalAmt,jdbcType=DECIMAL}, #{withdrawTotalCount,jdbcType=INTEGER},
        #{updateTime,jdbcType=TIMESTAMP})
    </insert>
    <insert id="insertSelective" parameterType="com.miaoqian.transvc.domain.UserBalance" >
        insert into user_balance
        <trim prefix="(" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                id,
            </if>
            <if test="uid != null" >
                uid,
            </if>
            <if test="operateType != null" >
                operate_type,
            </if>
            <if test="usableSa != null" >
                usable_sa,
            </if>
            <if test="withdrawFreezeSa != null" >
                withdraw_freeze_sa,
            </if>
            <if test="investFreezeSa != null" >
                invest_freeze_sa,
            </if>
            <if test="repayFreezeSa != null" >
                repay_freeze_sa,
            </if>
            <if test="currentCapital != null" >
                current_capital,
            </if>
            <if test="currentInterest != null" >
                current_interest,
            </if>
            <if test="currentTotalCapital != null" >
                current_total_capital,
            </if>
            <if test="currentTotalInterest != null" >
                current_total_interest,
            </if>
            <if test="fixendCapital != null" >
                fixend_capital,
            </if>
            <if test="fixendInterest != null" >
                fixend_interest,
            </if>
            <if test="fixendTotalCapital != null" >
                fixend_total_capital,
            </if>
            <if test="fixendTotalInterest != null" >
                fixend_total_interest,
            </if>
            <if test="fixperiodCapital != null" >
                fixperiod_capital,
            </if>
            <if test="fixperiodInterest != null" >
                fixperiod_interest,
            </if>
            <if test="fixperiodTotalCapital != null" >
                fixperiod_total_capital,
            </if>
            <if test="fixperiodTotalInterest != null" >
                fixperiod_total_interest,
            </if>
            <if test="rechargeTotalAmt != null" >
                recharge_total_amt,
            </if>
            <if test="rechargeTotalCount != null" >
                recharge_total_count,
            </if>
            <if test="withdrawTotalAmt != null" >
                withdraw_total_amt,
            </if>
            <if test="withdrawTotalCount != null" >
                withdraw_total_count,
            </if>
            <if test="updateTime != null" >
                update_time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides="," >
            <if test="id != null" >
                #{id,jdbcType=INTEGER},
            </if>
            <if test="uid != null" >
                #{uid,jdbcType=VARCHAR},
            </if>
            <if test="operateType != null" >
                #{operateType,jdbcType=VARCHAR},
            </if>
            <if test="usableSa != null" >
                #{usableSa,jdbcType=DECIMAL},
            </if>
            <if test="withdrawFreezeSa != null" >
                #{withdrawFreezeSa,jdbcType=DECIMAL},
            </if>
            <if test="investFreezeSa != null" >
                #{investFreezeSa,jdbcType=DECIMAL},
            </if>
            <if test="repayFreezeSa != null" >
                #{repayFreezeSa,jdbcType=DECIMAL},
            </if>
            <if test="currentCapital != null" >
                #{currentCapital,jdbcType=DECIMAL},
            </if>
            <if test="currentInterest != null" >
                #{currentInterest,jdbcType=DECIMAL},
            </if>
            <if test="currentTotalCapital != null" >
                #{currentTotalCapital,jdbcType=DECIMAL},
            </if>
            <if test="currentTotalInterest != null" >
                #{currentTotalInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixendCapital != null" >
                #{fixendCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixendInterest != null" >
                #{fixendInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixendTotalCapital != null" >
                #{fixendTotalCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixendTotalInterest != null" >
                #{fixendTotalInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodCapital != null" >
                #{fixperiodCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodInterest != null" >
                #{fixperiodInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodTotalCapital != null" >
                #{fixperiodTotalCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodTotalInterest != null" >
                #{fixperiodTotalInterest,jdbcType=DECIMAL},
            </if>
            <if test="rechargeTotalAmt != null" >
                #{rechargeTotalAmt,jdbcType=DECIMAL},
            </if>
            <if test="rechargeTotalCount != null" >
                #{rechargeTotalCount,jdbcType=INTEGER},
            </if>
            <if test="withdrawTotalAmt != null" >
                #{withdrawTotalAmt,jdbcType=DECIMAL},
            </if>
            <if test="withdrawTotalCount != null" >
                #{withdrawTotalCount,jdbcType=INTEGER},
            </if>
            <if test="updateTime != null" >
                #{updateTime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.miaoqian.transvc.domain.UserBalance" >
        update user_balance
        <set >
            <if test="uid != null" >
                uid = #{uid,jdbcType=VARCHAR},
            </if>
            <if test="operateType != null" >
                operate_type = #{operateType,jdbcType=VARCHAR},
            </if>
            <if test="usableSa != null" >
                usable_sa = #{usableSa,jdbcType=DECIMAL},
            </if>
            <if test="withdrawFreezeSa != null" >
                withdraw_freeze_sa = #{withdrawFreezeSa,jdbcType=DECIMAL},
            </if>
            <if test="investFreezeSa != null" >
                invest_freeze_sa = #{investFreezeSa,jdbcType=DECIMAL},
            </if>
            <if test="repayFreezeSa != null" >
                repay_freeze_sa = #{repayFreezeSa,jdbcType=DECIMAL},
            </if>
            <if test="currentCapital != null" >
                current_capital = #{currentCapital,jdbcType=DECIMAL},
            </if>
            <if test="currentInterest != null" >
                current_interest = #{currentInterest,jdbcType=DECIMAL},
            </if>
            <if test="currentTotalCapital != null" >
                current_total_capital = #{currentTotalCapital,jdbcType=DECIMAL},
            </if>
            <if test="currentTotalInterest != null" >
                current_total_interest = #{currentTotalInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixendCapital != null" >
                fixend_capital = #{fixendCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixendInterest != null" >
                fixend_interest = #{fixendInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixendTotalCapital != null" >
                fixend_total_capital = #{fixendTotalCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixendTotalInterest != null" >
                fixend_total_interest = #{fixendTotalInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodCapital != null" >
                fixperiod_capital = #{fixperiodCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodInterest != null" >
                fixperiod_interest = #{fixperiodInterest,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodTotalCapital != null" >
                fixperiod_total_capital = #{fixperiodTotalCapital,jdbcType=DECIMAL},
            </if>
            <if test="fixperiodTotalInterest != null" >
                fixperiod_total_interest = #{fixperiodTotalInterest,jdbcType=DECIMAL},
            </if>
            <if test="rechargeTotalAmt != null" >
                recharge_total_amt = #{rechargeTotalAmt,jdbcType=DECIMAL},
            </if>
            <if test="rechargeTotalCount != null" >
                recharge_total_count = #{rechargeTotalCount,jdbcType=INTEGER},
            </if>
            <if test="withdrawTotalAmt != null" >
                withdraw_total_amt = #{withdrawTotalAmt,jdbcType=DECIMAL},
            </if>
            <if test="withdrawTotalCount != null" >
                withdraw_total_count = #{withdrawTotalCount,jdbcType=INTEGER},
            </if>
            <if test="updateTime != null" >
                update_time = #{updateTime,jdbcType=TIMESTAMP},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.miaoqian.transvc.domain.UserBalance" >
        update user_balance
        set uid = #{uid,jdbcType=VARCHAR},
        operate_type = #{operateType,jdbcType=VARCHAR},
        usable_sa = #{usableSa,jdbcType=DECIMAL},
        withdraw_freeze_sa = #{withdrawFreezeSa,jdbcType=DECIMAL},
        invest_freeze_sa = #{investFreezeSa,jdbcType=DECIMAL},
        repay_freeze_sa = #{repayFreezeSa,jdbcType=DECIMAL},
        current_capital = #{currentCapital,jdbcType=DECIMAL},
        current_interest = #{currentInterest,jdbcType=DECIMAL},
        current_total_capital = #{currentTotalCapital,jdbcType=DECIMAL},
        current_total_interest = #{currentTotalInterest,jdbcType=DECIMAL},
        fixend_capital = #{fixendCapital,jdbcType=DECIMAL},
        fixend_interest = #{fixendInterest,jdbcType=DECIMAL},
        fixend_total_capital = #{fixendTotalCapital,jdbcType=DECIMAL},
        fixend_total_interest = #{fixendTotalInterest,jdbcType=DECIMAL},
        fixperiod_capital = #{fixperiodCapital,jdbcType=DECIMAL},
        fixperiod_interest = #{fixperiodInterest,jdbcType=DECIMAL},
        fixperiod_total_capital = #{fixperiodTotalCapital,jdbcType=DECIMAL},
        fixperiod_total_interest = #{fixperiodTotalInterest,jdbcType=DECIMAL},
        recharge_total_amt = #{rechargeTotalAmt,jdbcType=DECIMAL},
        recharge_total_count = #{rechargeTotalCount,jdbcType=INTEGER},
        withdraw_total_amt = #{withdrawTotalAmt,jdbcType=DECIMAL},
        withdraw_total_count = #{withdrawTotalCount,jdbcType=INTEGER},
        update_time = #{updateTime,jdbcType=TIMESTAMP}
        where id = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateRechargeInfo" parameterType="java.util.Map">
        UPDATE user_balance
        SET usable_sa = usable_sa + #{rechargeSa, jdbcType=DECIMAL},
        recharge_total_amt = recharge_total_amt + #{rechargeSa, jdbcType=DECIMAL},
        recharge_total_count = recharge_total_count + 1
        update_time = #{updateTime, jdbcType=TIMESTAMP}
        WHERE uid = #{uid, jdbcType=VARCHAR} AND operate_type = #{operateType, jdbcType=VARCHAR}
    </update>
    <update id="updateWithdrawFailInfo" parameterType="java.util.Map">
        UPDATE user_balance
        SET usable_sa = usable_sa + #{aimUsableSa, jdbcType=DECIMAL},
        withdraw_freeze_sa = withdraw_freeze_sa - #{aimWithdrawFreezeSa, jdbcType=DECIMAL},
        update_time = #{aimUpdateTime, jdbcType=TIMESTAMP}
        WHERE uid = #{aimUid, jdbcType=VARCHAR} AND operate_type = #{aimOperateType, jdbcType=VARCHAR} AND withdraw_freeze_sa >= #{aimWithdrawFreezeSa, jdbcType=DECIMAL}
    </update>
    <select id="selectByUserIDOperateType" resultMap="BaseResultMap" parameterType="java.util.Map">
        SELECT
        <include refid="Base_Column_List" />
        FROM user_balance
        WHERE uid = #{uid, jdbcType=VARCHAR} AND operate_type = #{operateType, jdbcType=VARCHAR}
    </select>
    <update id="updateWithdrawFreeze" parameterType="java.util.Map">
        UPDATE user_balance
        SET usable_sa = usable_sa - #{withdrawAmt, jdbcType=DECIMAL},
        withdraw_freeze_sa = withdraw_freeze_sa + #{withdrawAmt, jdbcType=DECIMAL},
        update_time = #{updateTime, jdbcType=TIMESTAMP}
        WHERE uid = #{uid, jdbcType=VARCHAR} AND operate_type = #{operateType, jdbcType=VARCHAR} AND usable_sa >= #{withdrawAmt, jdbcType=DECIMAL}
    </update>
    <update id="updateWithdrawCallbackSucess" parameterType="java.util.Map">
        UPDATE user_balance
        SET withdraw_freeze_sa = withdraw_freeze_sa - #{withdrawAmt, jdbcType=DECIMAL},
        withdraw_total_count = withdraw_total_count + 1,
        withdraw_total_amt = withdraw_total_amt + #{withdrawAmt, jdbcType=DECIMAL},
        update_time = #{updateTime, jdbcType=TIMESTAMP}
        WHERE uid = #{uid, jdbcType=VARCHAR} AND operate_type = #{operateType, jdbcType=VARCHAR} AND withdraw_freeze_sa >= #{withdrawAmt, jdbcType=DECIMAL}
    </update>
    <update id="updateWithdrawCallbackFail" parameterType="java.util.Map">
        UPDATE user_balance
        SET usable_sa = usable_sa + #{withdrawAmt, jdbcType=DECIMAL},
        withdraw_freeze_sa = withdraw_freeze_sa - #{withdrawAmt, jdbcType=DECIMAL},
        update_time = #{updateTime}
        WHERE uid = #{uid, jdbcType=VARCHAR} AND operate_type = #{operateType, jdbcType=VARCHAR} AND withdraw_freeze_sa >=#{withdrawAmt, jdbcType=DECIMAL}
    </update>
</mapper>