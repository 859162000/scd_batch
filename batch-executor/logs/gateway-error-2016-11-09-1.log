2016-11-09 17:16:58 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@13c3543[count=0,pageSize=1000,curPage=1], com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@1d7ccfe[phase=1,phaseStatus=2,retryTime=0,jobType=1009,databaseId=0,tableId=0,uuid=6d85e73b-3a1f-4aef-85e7-3b3a1ffaef62,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 17:17:09 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], ROOT_FILE_DIR=2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@10ce331[dbId=0,tableId=0]}], error: java.lang.NullPointerException
	at java.io.File.<init>(File.java:360)
	at com.scd.batch.common.job.util.FileBufferWriter.<init>(FileBufferWriter.java:51)
	at com.scd.batch.common.job.util.FileBufferWriter.<init>(FileBufferWriter.java:44)
	at com.scd.batch.common.job.batch.TargetFileWriteHandler.init(TargetFileWriteHandler.java:47)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.initDataFlow(CrawlerDataFlowBatchJob.java:243)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.beforeExecute(CrawlerDataFlowBatchJob.java:66)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:106)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)

2016-11-09 17:19:07 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@8d5ed3[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@1c7208d[phase=1,phaseStatus=2,retryTime=1,jobType=1009,databaseId=0,tableId=0,uuid=b78b0da5-782f-4b4b-8b0d-a5782fcb4b03,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 17:19:17 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@516c91[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\trade\UserBalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select uid         from user_balance         where updateTime >= ?         order by id
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\trade\UserBalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select uid         from user_balance         where updateTime >= ?         order by id
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:421)
	at com.sun.proxy.$Proxy38.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:206)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:114)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:58)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:43)
	at com.sun.proxy.$Proxy92.getActiveUIDs(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy93.getActiveUIDs(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:83)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$12(HuiFuUserBalanceCrawlerJob.java:59)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Unknown column 'updateTime' in 'where clause'
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:422)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
	at com.mysql.jdbc.Util.getInstance(Util.java:386)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1362)
	at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:493)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:55)
	at com.sun.proxy.$Proxy116.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:56)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:70)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:57)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:259)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:132)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:105)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:81)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:104)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:98)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:408)
	... 54 more

2016-11-09 17:21:05 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@17af13[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@d48673[phase=1,phaseStatus=2,retryTime=2,jobType=1009,databaseId=0,tableId=0,uuid=489b47d5-5393-45c7-9b47-d5539335c7f7,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 17:21:15 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@8d5ed3[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: A query was run and no Result Maps were found for the Mapped Statement 'com.scd.batch.common.dao.acct.UserRegisterDao.getAcctListByUIdList'.  It's likely that neither a Result Type nor a Result Map was specified.
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.executor.ExecutorException: A query was run and no Result Maps were found for the Mapped Statement 'com.scd.batch.common.dao.acct.UserRegisterDao.getAcctListByUIdList'.  It's likely that neither a Result Type nor a Result Map was specified.
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:76)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:421)
	at com.sun.proxy.$Proxy38.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:206)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:114)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:58)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:43)
	at com.sun.proxy.$Proxy103.getAcctListByUIdList(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy104.getAcctListByUIdList(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:86)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$12(HuiFuUserBalanceCrawlerJob.java:59)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more
Caused by: org.apache.ibatis.executor.ExecutorException: A query was run and no Result Maps were found for the Mapped Statement 'com.scd.batch.common.dao.acct.UserRegisterDao.getAcctListByUIdList'.  It's likely that neither a Result Type nor a Result Map was specified.
	at org.apache.ibatis.executor.resultset.DefaultResultSetHandler.validateResultMapsCount(DefaultResultSetHandler.java:222)
	at org.apache.ibatis.executor.resultset.DefaultResultSetHandler.handleResultSets(DefaultResultSetHandler.java:149)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:57)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:70)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:57)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:259)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:132)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:105)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:81)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:104)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:98)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:408)
	... 54 more

2016-11-09 17:23:25 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@731692[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@2bf610[phase=1,phaseStatus=2,retryTime=1,jobType=1009,databaseId=0,tableId=0,uuid=b9d5543b-e852-4bfb-9554-3be852ebfb4d,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 17:23:35 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@1b663d0[dbId=0,tableId=0]}], error: java.lang.RuntimeException: java.lang.NumberFormatException: For input string: "58,700.00"
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: java.lang.NumberFormatException: For input string: "58,700.00"
	at sun.misc.FloatingDecimal.readJavaFormatString(FloatingDecimal.java:2043)
	at sun.misc.FloatingDecimal.parseDouble(FloatingDecimal.java:110)
	at java.lang.Double.parseDouble(Double.java:538)
	at java.lang.Double.valueOf(Double.java:502)
	at com.scd.batch.reconciliation.util.TransferUtil.buildUserBalance(TransferUtil.java:157)
	at com.scd.batch.reconciliation.crawler.UserBalanceCrawler.crawler(UserBalanceCrawler.java:72)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:88)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$12(HuiFuUserBalanceCrawlerJob.java:59)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more

2016-11-09 17:51:12 [main] ERROR com.scd.batch.common.daycut.service.impl.DayCutServiceImpl - Load current accounting date exception.
org.apache.ibatis.builder.IncompleteElementException: Could not find result map com.scd.batch.common.dao.trade.UserBalanceDao.Sum_UserBalance_List
	at org.apache.ibatis.builder.MapperBuilderAssistant.setStatementResultMap(MapperBuilderAssistant.java:373) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.builder.MapperBuilderAssistant.addMappedStatement(MapperBuilderAssistant.java:311) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:109) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.session.Configuration.buildAllStatements(Configuration.java:698) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.session.Configuration.hasStatement(Configuration.java:668) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.session.Configuration.hasStatement(Configuration.java:663) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.binding.MapperMethod$SqlCommand.<init>(MapperMethod.java:175) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.binding.MapperMethod.<init>(MapperMethod.java:38) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.binding.MapperProxy.cachedMapperMethod(MapperProxy.java:49) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:42) ~[mybatis-3.2.3.jar:3.2.3]
	at com.sun.proxy.$Proxy39.loadDate(Unknown Source) ~[?:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_73]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_73]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_73]
	at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_73]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) ~[spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) ~[spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) ~[spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37) ~[classes/:?]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) ~[spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) ~[spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at com.sun.proxy.$Proxy41.loadDate(Unknown Source) ~[?:?]
	at com.scd.batch.common.daycut.service.impl.DayCutServiceImpl.load(DayCutServiceImpl.java:23) [classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_73]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_73]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_73]
	at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_73]
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99) [spring-tx-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:281) [spring-tx-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96) [spring-tx-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at com.sun.proxy.$Proxy46.load(Unknown Source) [?:?]
	at com.scd.batch.common.job.batch.control.JobControlService.grabJobControl(JobControlService.java:91) [classes/:?]
	at com.scd.batch.common.job.batch.control.JobControlService$$FastClassBySpringCGLIB$$31f43af7.invoke(<generated>) [classes/:?]
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204) [spring-core-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:720) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99) [spring-tx-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:281) [spring-tx-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96) [spring-tx-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:655) [spring-aop-4.3.3.RELEASE.jar:4.3.3.RELEASE]
	at com.scd.batch.common.job.batch.control.JobControlService$$EnhancerBySpringCGLIB$$7913fdd6.grabJobControl(<generated>) [classes/:?]
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.beforeExecute(CrawlerDataFlowBatchJob.java:59) [classes/:?]
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:106) [classes/:?]
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88) [classes/:?]
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70) [classes/:?]
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145) [classes/:?]
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60) [classes/:?]
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35) [classes/:?]
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_73]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_73]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_73]
	at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_73]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45) [junit-4.10.jar:?]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15) [junit-4.10.jar:?]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42) [junit-4.10.jar:?]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263) [junit-4.10.jar:?]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68) [junit-4.10.jar:?]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300) [junit-4.10.jar:?]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157) [junit-4.10.jar:?]
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119) [junit-rt.jar:?]
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42) [junit-rt.jar:?]
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234) [junit-rt.jar:?]
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74) [junit-rt.jar:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_73]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_73]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_73]
	at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_73]
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) [idea_rt.jar:?]
Caused by: java.lang.IllegalArgumentException: Result Maps collection does not contain value for com.scd.batch.common.dao.trade.UserBalanceDao.Sum_UserBalance_List
	at org.apache.ibatis.session.Configuration$StrictMap.get(Configuration.java:791) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.session.Configuration.getResultMap(Configuration.java:550) ~[mybatis-3.2.3.jar:3.2.3]
	at org.apache.ibatis.builder.MapperBuilderAssistant.setStatementResultMap(MapperBuilderAssistant.java:371) ~[mybatis-3.2.3.jar:3.2.3]
	... 81 more
2016-11-09 17:51:12 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={}], error: com.scd.batch.common.daycut.exception.DayCutException: Load current accounting date exception.
	at com.scd.batch.common.daycut.service.impl.DayCutServiceImpl.load(DayCutServiceImpl.java:27)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:281)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy46.load(Unknown Source)
	at com.scd.batch.common.job.batch.control.JobControlService.grabJobControl(JobControlService.java:91)
	at com.scd.batch.common.job.batch.control.JobControlService$$FastClassBySpringCGLIB$$31f43af7.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:720)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:281)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:655)
	at com.scd.batch.common.job.batch.control.JobControlService$$EnhancerBySpringCGLIB$$7913fdd6.grabJobControl(<generated>)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.beforeExecute(CrawlerDataFlowBatchJob.java:59)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:106)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.apache.ibatis.builder.IncompleteElementException: Could not find result map com.scd.batch.common.dao.trade.UserBalanceDao.Sum_UserBalance_List
	at org.apache.ibatis.builder.MapperBuilderAssistant.setStatementResultMap(MapperBuilderAssistant.java:373)
	at org.apache.ibatis.builder.MapperBuilderAssistant.addMappedStatement(MapperBuilderAssistant.java:311)
	at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:109)
	at org.apache.ibatis.session.Configuration.buildAllStatements(Configuration.java:698)
	at org.apache.ibatis.session.Configuration.hasStatement(Configuration.java:668)
	at org.apache.ibatis.session.Configuration.hasStatement(Configuration.java:663)
	at org.apache.ibatis.binding.MapperMethod$SqlCommand.<init>(MapperMethod.java:175)
	at org.apache.ibatis.binding.MapperMethod.<init>(MapperMethod.java:38)
	at org.apache.ibatis.binding.MapperProxy.cachedMapperMethod(MapperProxy.java:49)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:42)
	at com.sun.proxy.$Proxy39.loadDate(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy41.loadDate(Unknown Source)
	at com.scd.batch.common.daycut.service.impl.DayCutServiceImpl.load(DayCutServiceImpl.java:23)
	... 59 more
Caused by: java.lang.IllegalArgumentException: Result Maps collection does not contain value for com.scd.batch.common.dao.trade.UserBalanceDao.Sum_UserBalance_List
	at org.apache.ibatis.session.Configuration$StrictMap.get(Configuration.java:791)
	at org.apache.ibatis.session.Configuration.getResultMap(Configuration.java:550)
	at org.apache.ibatis.builder.MapperBuilderAssistant.setStatementResultMap(MapperBuilderAssistant.java:371)
	... 81 more

2016-11-09 17:51:12 [main] ERROR com.scd.batch.executor.job.BatchLauncher - BatchLauncher failed for args: -n, huiFuUserBalanceCrawler, -p, classpath:META-INF/ApplicationContext-executor.xml, -f
java.lang.NullPointerException
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.clearDataFlow(CrawlerDataFlowBatchJob.java:253) ~[classes/:?]
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.handleException(CrawlerDataFlowBatchJob.java:124) ~[classes/:?]
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:119) ~[classes/:?]
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88) ~[classes/:?]
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70) ~[classes/:?]
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145) ~[classes/:?]
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60) ~[classes/:?]
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35) [classes/:?]
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338) [test-classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_73]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_73]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_73]
	at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_73]
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45) [junit-4.10.jar:?]
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15) [junit-4.10.jar:?]
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42) [junit-4.10.jar:?]
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263) [junit-4.10.jar:?]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68) [junit-4.10.jar:?]
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222) [junit-4.10.jar:?]
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300) [junit-4.10.jar:?]
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157) [junit-4.10.jar:?]
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119) [junit-rt.jar:?]
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42) [junit-rt.jar:?]
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234) [junit-rt.jar:?]
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74) [junit-rt.jar:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_73]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_73]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_73]
	at java.lang.reflect.Method.invoke(Method.java:497) ~[?:1.8.0_73]
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144) [idea_rt.jar:?]
2016-11-09 17:53:28 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@28b346[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@1e49cb2[phase=1,phaseStatus=2,retryTime=2,jobType=1009,databaseId=0,tableId=0,uuid=3778ca5f-6c0c-458c-b8ca-5f6c0ca58ccc,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 17:53:38 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@17af971[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\trade\UserBalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select                   uid,         COALESCE(sum(usable_sa), 0) as usable_sa,         COALESCE(sum(withdraw_freeze_sa + invest_freeze_sa + repay_freeze_sa + capital_freeze_sa), 0) as freezeSa,               from user_balance         where update_time >= ?
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\trade\UserBalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select                   uid,         COALESCE(sum(usable_sa), 0) as usable_sa,         COALESCE(sum(withdraw_freeze_sa + invest_freeze_sa + repay_freeze_sa + capital_freeze_sa), 0) as freezeSa,               from user_balance         where update_time >= ?
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:421)
	at com.sun.proxy.$Proxy38.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:206)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:114)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:58)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:43)
	at com.sun.proxy.$Proxy92.getActiveUIDs(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy93.getActiveUIDs(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:85)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$1(HuiFuUserBalanceCrawlerJob.java:61)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where update_time >= '2016-11-09 00:00:00'' at line 5
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:422)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
	at com.mysql.jdbc.Util.getInstance(Util.java:386)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1362)
	at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:493)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:55)
	at com.sun.proxy.$Proxy116.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:56)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:70)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:57)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:259)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:132)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:105)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:81)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:104)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:98)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:408)
	... 54 more

2016-11-09 18:11:57 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@1c7208d[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@516c91[phase=1,phaseStatus=2,retryTime=1,jobType=1009,databaseId=0,tableId=0,uuid=ace38225-e12f-4dd3-a382-25e12f0dd305,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 18:12:07 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@129ef6[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\trade\UserBalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select                   uid,         COALESCE(sum(usable_sa), 0) as usable_sa,         COALESCE(sum(withdraw_freeze_sa + invest_freeze_sa + repay_freeze_sa + capital_freeze_sa), 0) as freezeSa,               from user_balance         where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP(?)
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\trade\UserBalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select                   uid,         COALESCE(sum(usable_sa), 0) as usable_sa,         COALESCE(sum(withdraw_freeze_sa + invest_freeze_sa + repay_freeze_sa + capital_freeze_sa), 0) as freezeSa,               from user_balance         where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP(?)
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:421)
	at com.sun.proxy.$Proxy38.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:206)
	at org.apache.ibatis.binding.MapperMethod.executeForMany(MapperMethod.java:114)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:58)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:43)
	at com.sun.proxy.$Proxy92.getActiveUIDs(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy93.getActiveUIDs(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:85)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$1(HuiFuUserBalanceCrawlerJob.java:61)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'from user_balance
        where UNIX_TIMESTAMP(update_time) >= UNIX_TIMESTAMP('2' at line 5
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:422)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
	at com.mysql.jdbc.Util.getInstance(Util.java:386)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1362)
	at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:493)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:55)
	at com.sun.proxy.$Proxy116.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:56)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:70)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:57)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:259)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:132)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:105)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:81)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:104)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:98)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:408)
	... 54 more

2016-11-09 18:13:23 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@1ac521d[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@af1bf6[phase=1,phaseStatus=2,retryTime=2,jobType=1009,databaseId=0,tableId=0,uuid=e2e40d18-6dd1-4dbf-a40d-186dd1cdbf85,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 18:13:33 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@9bd55d[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.apache.ibatis.binding.BindingException: Invalid bound statement (not found): com.scd.batch.common.dao.reconciliation.HuiFuUserBalanceDao.checkExists
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.apache.ibatis.binding.BindingException: Invalid bound statement (not found): com.scd.batch.common.dao.reconciliation.HuiFuUserBalanceDao.checkExists
	at org.apache.ibatis.binding.MapperMethod$SqlCommand.<init>(MapperMethod.java:184)
	at org.apache.ibatis.binding.MapperMethod.<init>(MapperMethod.java:38)
	at org.apache.ibatis.binding.MapperProxy.cachedMapperMethod(MapperProxy.java:49)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:42)
	at com.sun.proxy.$Proxy102.checkExists(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.update2DB(HuiFuUserBalanceCrawlerJob.java:113)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:104)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$1(HuiFuUserBalanceCrawlerJob.java:61)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more

2016-11-09 18:21:11 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@8cda75[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@1049056[phase=1,phaseStatus=2,retryTime=1,jobType=1009,databaseId=0,tableId=0,uuid=cc0fa260-59db-4ec8-8fa2-6059db5ec80a,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 18:21:20 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@968732[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\reconciliation\BalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select count(1)         from r_balance         where USER_CUST_ID = ?
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.springframework.jdbc.BadSqlGrammarException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
### The error may exist in file [F:\github\scd_batch\batch-common\target\classes\META-INF\mybatis\mapper\reconciliation\BalanceMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select count(1)         from r_balance         where USER_CUST_ID = ?
### Cause: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
; bad SQL grammar []; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
	at org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.doTranslate(SQLErrorCodeSQLExceptionTranslator.java:231)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:73)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:74)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:421)
	at com.sun.proxy.$Proxy38.selectOne(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectOne(SqlSessionTemplate.java:166)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:63)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:43)
	at com.sun.proxy.$Proxy102.checkExists(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.update2DB(HuiFuUserBalanceCrawlerJob.java:113)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:104)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$1(HuiFuUserBalanceCrawlerJob.java:61)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: Table 'db_user.r_balance' doesn't exist
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:422)
	at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
	at com.mysql.jdbc.Util.getInstance(Util.java:386)
	at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1052)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609)
	at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541)
	at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:2002)
	at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:2163)
	at com.mysql.jdbc.ConnectionImpl.execSQL(ConnectionImpl.java:2624)
	at com.mysql.jdbc.PreparedStatement.executeInternal(PreparedStatement.java:2127)
	at com.mysql.jdbc.PreparedStatement.execute(PreparedStatement.java:1362)
	at com.alibaba.druid.pool.DruidPooledPreparedStatement.execute(DruidPooledPreparedStatement.java:493)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.ibatis.logging.jdbc.PreparedStatementLogger.invoke(PreparedStatementLogger.java:55)
	at com.sun.proxy.$Proxy116.execute(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.query(PreparedStatementHandler.java:56)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.query(RoutingStatementHandler.java:70)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:57)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:259)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:132)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:105)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:81)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:104)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:98)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectOne(DefaultSqlSession.java:62)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:408)
	... 43 more

2016-11-09 18:24:53 [main] ERROR com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob - job execute error, job desc: huiFuUserBalanceCrawler.job, context: ExecutorContext[status=error,attaches={com.scd.batch.common.utils.ShortDate=2016-11-09, com.scd.batch.common.utils.Pagination=com.scd.batch.common.utils.Pagination@d6cd34[count=0,pageSize=1000,curPage=1], TARGET_FILE_NAME=huiFuUserBalanceCrawler_0_0, com.scd.batch.common.job.batch.control.JobControl=com.scd.batch.common.job.batch.control.JobControl@15d6168[phase=1,phaseStatus=2,retryTime=2,jobType=1009,databaseId=0,tableId=0,uuid=4d5d0aee-c23c-4b3d-9d0a-eec23c1b3dec,accountDate=Wed Nov 09 00:00:00 CST 2016,startTime=Wed Nov 09 18:25:03 CST 2016,endTime=<null>,checkPoint=0,id=292,partitionId=0,version=0,created=Wed Nov 09 11:49:06 CST 2016,modified=Wed Nov 09 11:49:06 CST 2016], SOURCE_FILE_NAME=huiFuUserBalanceCrawler_0_0, ROOT_FILE_DIR=\tmp\reconciliation\huiFuUserBalance\2016-11-09, com.scd.batch.common.utils.TableSpec=com.scd.batch.common.utils.TableSpec@1b2faa6[dbId=0,tableId=0]}], error: java.lang.RuntimeException: org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.reflection.ReflectionException: There is no getter for property named 'userCustId' in 'class com.scd.batch.common.entity.reconciliation.HuiFuUserBalanceEntity'
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:96)
	at com.scd.batch.common.job.executor.AbstractExecutor.process(AbstractExecutor.java:113)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:88)
	at com.scd.batch.common.job.executor.AbstractExecutor.start(AbstractExecutor.java:70)
	at com.scd.batch.common.job.command.JobCommand.run(JobCommand.java:145)
	at com.scd.batch.executor.job.BatchLauncher.process(BatchLauncher.java:60)
	at com.scd.batch.executor.job.BatchLauncher.main(BatchLauncher.java:35)
	at com.scd.batch.executor.job.BatchLauncherTest.testProcessJobSuccess_huiFuUserBalanceCrawler(BatchLauncherTest.java:338)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:157)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:119)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:42)
	at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:234)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at com.intellij.rt.execution.application.AppMain.main(AppMain.java:144)
Caused by: org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.reflection.ReflectionException: There is no getter for property named 'userCustId' in 'class com.scd.batch.common.entity.reconciliation.HuiFuUserBalanceEntity'
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:76)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:421)
	at com.sun.proxy.$Proxy38.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:254)
	at org.apache.ibatis.binding.MapperMethod.execute(MapperMethod.java:46)
	at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:43)
	at com.sun.proxy.$Proxy106.insert(Unknown Source)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at com.scd.batch.common.mybatis.multidb.MultiDBInterceptor.invoke(MultiDBInterceptor.java:37)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at com.sun.proxy.$Proxy107.insert(Unknown Source)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.update2DB(HuiFuUserBalanceCrawlerJob.java:116)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.batchRead(HuiFuUserBalanceCrawlerJob.java:104)
	at com.scd.batch.reconciliation.job.HuiFuUserBalanceCrawlerJob.lambda$getSourceDataProvider$1(HuiFuUserBalanceCrawlerJob.java:61)
	at com.scd.batch.common.job.batch.CrawlerDataFlowBatchJob.execute(CrawlerDataFlowBatchJob.java:75)
	... 34 more
Caused by: org.apache.ibatis.reflection.ReflectionException: There is no getter for property named 'userCustId' in 'class com.scd.batch.common.entity.reconciliation.HuiFuUserBalanceEntity'
	at org.apache.ibatis.reflection.Reflector.getGetInvoker(Reflector.java:377)
	at org.apache.ibatis.reflection.MetaClass.getGetInvoker(MetaClass.java:167)
	at org.apache.ibatis.reflection.wrapper.BeanWrapper.getBeanProperty(BeanWrapper.java:149)
	at org.apache.ibatis.reflection.wrapper.BeanWrapper.get(BeanWrapper.java:45)
	at org.apache.ibatis.reflection.MetaObject.getValue(MetaObject.java:113)
	at org.apache.ibatis.reflection.MetaObject.getValue(MetaObject.java:110)
	at org.apache.ibatis.scripting.defaults.DefaultParameterHandler.setParameters(DefaultParameterHandler.java:72)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.parameterize(PreparedStatementHandler.java:77)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.parameterize(RoutingStatementHandler.java:58)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:71)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:44)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:100)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:75)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:148)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:137)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:408)
	... 54 more

